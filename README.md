# Smart Park 智慧园区管理系统

## 项目概述

Smart Park 是一个面向科技园区的综合管理系统，提供园区企业、员工以及园区管理方的各种管理和服务功能。

## 主要功能

- 园区信息发布与通知
- 企业信息管理
- 合同与租赁管理
- 账单管理
- 服务申请与报修
- 访客管理
- 活动管理
- 调查问卷
- 需求发布

## 技术栈

- 前端：React, TypeScript, Ant Design
- 后端：Node.js, Express, TypeORM
- 数据库：MySQL
- 部署：Docker

## 通知公告权限系统

系统实现了完整的通知公告权限管理功能，不同角色拥有不同的权限：

### 角色与权限

- **园区管理员**：拥有全部权限，包括创建、编辑、删除、审核、发布、置顶通知公告
- **内容管理员**：可以创建、编辑、删除通知公告，但无权审核和发布
- **审核员**：可以审核和发布通知公告，但无权创建和编辑
- **企业管理员**：可以查看和确认通知公告
- **企业员工**：可以查看和确认通知公告
- **公众用户**：仅可查看公开的通知公告

### 权限定义

| 权限 | 说明 |
|------|------|
| announcement:create | 创建通知公告 |
| announcement:update | 编辑通知公告 |
| announcement:delete | 删除通知公告 |
| announcement:review | 审核通知公告 |
| announcement:publish | 发布通知公告 |
| announcement:top | 置顶通知公告 |
| announcement:view | 查看通知公告 |
| announcement:confirm | 确认通知公告 |

## 开发环境设置

### 前置条件

- Node.js v16 或更高版本
- npm v8 或更高版本
- MySQL 8.0 或更高版本

### 安装依赖

```bash
npm install
```

### 启动开发服务器

在 Windows PowerShell 中启动服务器:

```bash
.\start-server.ps1
```

或者分别启动前端和后端:

```bash
# 启动后端
cd server
npm run dev

# 启动前端 (新终端)
cd ..
npm run dev
```

## 测试通知公告权限

通过以下步骤测试不同角色的权限:

1. 使用不同角色账号登录系统:
   - 园区管理员: 用户名 `admin`，密码 `123456`
   - 内容管理员: 用户名 `content`，密码 `123456`
   - 审核员: 用户名 `reviewer`，密码 `123456`
   - 企业用户: 用户名 `enterprise`，密码 `123456`

2. 通知公告工作流:
   - 内容管理员创建通知，填写内容，提交审核
   - 审核员审核通知，可以批准发布或拒绝
   - 发布后的通知可由目标用户查看
   - 设置了"需要确认"的通知，用户可以确认已读

## 部署

### 使用 Docker 部署

```bash
# 构建镜像
docker-compose build

# 启动服务
docker-compose up -d
```

## 项目结构

```
.
├── data/                  # 数据文件
├── docs/                  # 文档
├── src/                   # 前端源代码
│   ├── api/               # API 请求
│   ├── components/        # 组件
│   ├── contexts/          # 上下文
│   ├── layouts/           # 布局组件
│   ├── models/            # 数据模型
│   ├── pages/             # 页面
│   ├── services/          # 服务
│   ├── styles/            # 样式
│   ├── utils/             # 工具函数
│   ├── App.tsx            # 应用入口
│   └── main.tsx           # 主渲染文件
├── server/                # 后端源代码
│   ├── controllers/       # 控制器
│   ├── entities/          # 实体
│   ├── middlewares/       # 中间件
│   ├── routes/            # 路由
│   ├── services/          # 服务层
│   └── index.ts           # 服务器入口
└── public/                # 静态资源
```

## 系统功能

### 智慧园区综合管理平台主要功能

- **工作门户**：系统总览、待办事项、通知公告等
- **招商管理**：客户管理、渠道管理、合同签约、企业入驻等
- **运营管理**：能源表管理、企业管理、合同管理、租控图等
- **财务管理**：押金管理、账单管理、收款管理、开票管理等
- **系统管理**：用户管理、角色管理、菜单管理、日志管理等
- **综合统计**：招商统计、合同统计、财务统计、资产统计等

### 公共服务平台主要功能

- **首页**：园区活动、服务导航、信息公开等
- **信息公开**：通知公告、政策文件、园区活动、需求发布、调查问卷
- **服务大厅**：
  - 物业服务：事件上报、维修申报、退租申请、退园申请
  - 配套服务：访客门禁申请、会议室预订、临停缴费、停车月卡、空调加时等
  - 成长服务：企业注册申请、融资服务申请
  - 增值服务：实验室申请、普惠算力申请
- **用户中心**：我的消息、我的预订、我的活动、我的申请、个人设置等

## 技术架构

- 前端：React + TypeScript + Ant Design + Vite
- 接口：RESTful API
- 响应式设计，支持多终端访问

## 环境要求

- Node.js >= 16.0.0
- npm >= 8.0.0 或 yarn >= 1.22.0
- 浏览器：Chrome, Firefox, Edge 等现代浏览器

## 业务流程

系统核心业务流程涵盖企业从意向入驻到最终退出的整个生命周期：

1. **招商阶段**
   - 意向客户通过公共服务平台提交意向
   - 招商人员跟进意向客户

2. **合同签订阶段**
   - 招商人员草拟合同并配置费用
   - 合同审核通过后，为企业生成账号
   - 企业支付押金/首期款

3. **履约阶段**
   - 企业正式入驻并使用各项服务
   - 财务定期生成账单，企业缴费
   - 合同变更或续签处理

4. **退租阶段**
   - 企业申请退租/退园
   - 办理退园手续，完成结算
   - 企业正式离开，账号失效

## 用户角色

系统涉及多种用户角色，包括：
- 园区管理方：招商、运营、财务等
- 企业用户：企业管理员、普通员工
- 公众用户：潜在客户、园区访客

## 常见问题

### 类型错误
如果遇到TypeScript类型相关的错误，请确保：
1. 已安装所有依赖项 `npm install`
2. 使用正确的Node.js版本（推荐v16+）

### 启动失败
如果项目无法正常启动：
1. 删除node_modules文件夹和package-lock.json
2. 重新执行`npm install`
3. 使用`node start.js`启动项目 